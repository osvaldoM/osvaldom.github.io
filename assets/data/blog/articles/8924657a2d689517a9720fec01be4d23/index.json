{"hash":"c2e9249aca6e305e079478118dc9cc61171c7886","data":{"article":{"title":"Dealing with currencies in php","content":"<h2 id=\"how-we-operate-with-currencies-in-php-and-what-problems-does-it-have\"><a href=\"#how-we-operate-with-currencies-in-php-and-what-problems-does-it-have\" aria-hidden=\"true\"><span class=\"icon icon-link heading-anchor\"></span></a>How we operate with currencies in PHP and what problems does it have?</h2>\n<p>One recurring mistake developers make is to perform mathematical operations on currencies using floats(floating point numbers), which might cause rounding errors and other issues.\nOne common approach to working with currencies is to use Martin Fowler's money pattern which in summary means:.</p>\n<ul>\n<li>Deal in the currencies smallest unit (for dollars that's cents, but don't assume all currencies have the same smallest unit).</li>\n<li>Store amounts as strings (for some cases, integers can be used)</li>\n<li>Perform all arithmetic operations using the BC or GMP extensions. For this example I used BCMath</li>\n</ul>\n<p>This approach is valid for cryptocurrencies as well, but we have to define a base fractional unit for the specific cryptocurrency we want to work with.</p>\n<h2 id=\"what-is-the-best-way-to-store-them-in-the-database\"><a href=\"#what-is-the-best-way-to-store-them-in-the-database\" aria-hidden=\"true\"><span class=\"icon icon-link heading-anchor\"></span></a>What is the best way to store them in the Database?</h2>\n<p>I believe that the best way for storing currencies in the database whenever possible would be to store the value as a decimal/numeric data type in one column and store the currency in a separate column (either a Foreign Key or an ISO currency code). Decimal/numeric data types have enough precision to support most common operations on currencies without losing accuracy.</p>\n<p>Alternatively, they could be stored as strings(eg: 250 USD) but this could make arithmetic database operations more difficult, which would also make reporting/analytics for instance, more complicated.</p>\n<h2 id=\"articles-about-martin-fowlers-pattern\"><a href=\"#articles-about-martin-fowlers-pattern\" aria-hidden=\"true\"><span class=\"icon icon-link heading-anchor\"></span></a>Articles about Martin Fowler's pattern:</h2>\n<p><a href=\"https://code.tutsplus.com/tutorials/money-pattern-the-right-way-to-represent-value-unit-pairs--net-35509\" target=\"_blank\" rel=\"noopener\">https://code.tutsplus.com/tutorials/money-pattern-the-right-way-to-represent-value-unit-pairs--net-35509</a>\n<a href=\"https://culttt.com/2014/05/28/handle-money-currency-web-applications/\" target=\"_blank\" rel=\"noopener\">https://culttt.com/2014/05/28/handle-money-currency-web-applications/</a>\n<a href=\"https://culttt.com/2014/06/04/working-money-currency-php/\" target=\"_blank\" rel=\"noopener\">https://culttt.com/2014/06/04/working-money-currency-php/</a>\n<a href=\"https://www.reddit.com/r/PHP/comments/4sxukz/how_to_properly_handle_money_in_php_and_mysql/\" target=\"_blank\" rel=\"noopener\">https://www.reddit.com/r/PHP/comments/4sxukz/how_to_properly_handle_money_in_php_and_mysql/</a></p>\n<h2 id=\"comparison-of-several-patterns-for-the-money-class\"><a href=\"#comparison-of-several-patterns-for-the-money-class\" aria-hidden=\"true\"><span class=\"icon icon-link heading-anchor\"></span></a>Comparison of several patterns for the Money class</h2>\n<p><a href=\"https://deque.blog/2017/08/17/a-study-of-4-money-class-designs-featuring-martin-fowler-kent-beck-and-ward-cunningham-implementations/\" target=\"_blank\" rel=\"noopener\">https://deque.blog/2017/08/17/a-study-of-4-money-class-designs-featuring-martin-fowler-kent-beck-and-ward-cunningham-implementations/</a></p>\n"}},"context":{}}