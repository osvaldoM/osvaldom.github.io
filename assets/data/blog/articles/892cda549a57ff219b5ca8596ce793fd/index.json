{"hash":"eef94eda544bbdb4bfce99631dc7c7ea9d01fa30","data":{"article":{"id":"892cda549a57ff219b5ca8596ce793fd","title":"Sending events from vue functional components","content":"<h2 id=\"what-are-functional-components\"><a href=\"#what-are-functional-components\" aria-hidden=\"true\"><span class=\"icon icon-link heading-anchor\"></span></a>What are functional components</h2>\n<p>A functional component in vue is a special type of component that is stateless, that is, it manages no internal state.</p>\n<p>The main advantage of not managing any internal state is that vue doesn't have to create a vue instance or observable properties for that component, and instead,\nthe component becomes a simple function which makes rendering much faster because the vue compiler has less work to do.</p>\n<p>Since a functional component is not attached to a vue instance and therefore, cannot emit events to its parent component, I wanted to share a simple pattern/workaround for overcoming this limitation.</p>\n<p>First, Let's create a normal(non-functional) vue component to display a list of notes called <code class=\"language-text\">NoteList.vue</code> . This component will delegate displaying list-items to a more specific component called <code class=\"language-text\">NoteListItem.vue</code>. </p>\n<p>NoteList.vue</p>\n<pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>template</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">></span></span>Notes<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>ul</span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span> <span class=\"token attr-name\">v-for</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>note in notes<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">:key</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>note.id<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>note-list-item</span> <span class=\"token attr-name\">:note</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>note<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">@remove-note</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>removeNote<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>note-list-item</span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>ul</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>template</span><span class=\"token punctuation\">></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\">\n    <span class=\"token keyword module\">import</span> <span class=\"token imports\"><span class=\"token maybe-class-name\">NoteListItem</span></span> <span class=\"token keyword module\">from</span> <span class=\"token string\">\"./NoteListItem\"</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword module\">export</span> <span class=\"token keyword module\">default</span> <span class=\"token punctuation\">{</span>\n        components<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token maybe-class-name\">NoteListItem</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token function\">data</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword control-flow\">return</span> <span class=\"token punctuation\">{</span>\n                notes<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n                    <span class=\"token punctuation\">{</span>\n                        id<span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n                        description<span class=\"token operator\">:</span> <span class=\"token string\">\"this is the first note\"</span><span class=\"token punctuation\">,</span>\n                    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                    <span class=\"token punctuation\">{</span>\n                        id<span class=\"token operator\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n                        description<span class=\"token operator\">:</span> <span class=\"token string\">\"this is the second note\"</span><span class=\"token punctuation\">,</span>\n                    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                    <span class=\"token punctuation\">{</span>\n                        id<span class=\"token operator\">:</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span>\n                        description<span class=\"token operator\">:</span> <span class=\"token string\">\"this is the third note\"</span><span class=\"token punctuation\">,</span>\n                    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                    <span class=\"token punctuation\">{</span>\n                        id<span class=\"token operator\">:</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span>\n                        description<span class=\"token operator\">:</span> <span class=\"token string\">\"this is the fourth note\"</span><span class=\"token punctuation\">,</span>\n                    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n                <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        methods<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token function\">removeNote</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">id</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token keyword\">const</span> noteIndex <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">notes</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">findIndex</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">note</span><span class=\"token punctuation\">)</span> <span class=\"token arrow operator\">=></span> note<span class=\"token punctuation\">.</span><span class=\"token property-access\">id</span> <span class=\"token operator\">===</span> id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n                <span class=\"token keyword control-flow\">if</span> <span class=\"token punctuation\">(</span>noteIndex <span class=\"token operator\">></span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                    <span class=\"token keyword control-flow\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token property-access\">notes</span><span class=\"token punctuation\">.</span><span class=\"token method function property-access\">splice</span><span class=\"token punctuation\">(</span>noteIndex<span class=\"token punctuation\">,</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span></code></pre>\n<p>NoteListItem.vue</p>\n<pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>template</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span>{{note.description}}<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">@click</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>$emit(<span class=\"token punctuation\">'</span>remove-note<span class=\"token punctuation\">'</span>,note.id)<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Remove<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>template</span><span class=\"token punctuation\">></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\">\n<span class=\"token keyword module\">export</span> <span class=\"token keyword module\">default</span> <span class=\"token punctuation\">{</span>\n  props<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    note<span class=\"token operator\">:</span> <span class=\"token known-class-name class-name\">Object</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span></code></pre>\n<p>Looking at the <code class=\"language-text\">NoteListItem.vue</code> component,  we can notice two things:</p>\n<ul>\n<li>It doesn't have any internal observable properties </li>\n<li>The data it uses to render is received through props</li>\n<li>It has no lifecycle methods </li>\n</ul>\n<p><code class=\"language-text\">NoteListItem.vue</code> has a very simple job, render a list item that it receives from it's parent, so we can tell Vue to optimize its rendering performance.</p>\n<p>Components within a <code class=\"language-text\">v-for</code> loop are usually great candidates for becoming functional.</p>\n<h2 id=\"making-a-component-functional\"><a href=\"#making-a-component-functional\" aria-hidden=\"true\"><span class=\"icon icon-link heading-anchor\"></span></a>Making a component functional.</h2>\n<p>In order to make a component functional, a few changes have to be made to the <code class=\"language-text\">NoteListItem.vue</code> component. The <code class=\"language-text\">NoteList</code> component remains unchanged.</p>\n<ul>\n<li>First, if we are using Single File Components we add the <code class=\"language-text\">functional</code> keyword in the template declaration </li>\n<li>Afterwords, props are accessed through a <code class=\"language-text\">props</code> object that contains the provided props. </li>\n</ul>\n<p>NoteListItem.vue</p>\n<pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>template</span> <span class=\"token attr-name\">functional</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span>{{props.note.description}}<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">@click</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>$emit(<span class=\"token punctuation\">'</span>remove-note<span class=\"token punctuation\">'</span>,note.id)<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Remove<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>template</span><span class=\"token punctuation\">></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\">\n<span class=\"token keyword module\">export</span> <span class=\"token keyword module\">default</span> <span class=\"token punctuation\">{</span>\n  props<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    note<span class=\"token operator\">:</span> <span class=\"token known-class-name class-name\">Object</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span></code></pre>\n<p>Currently, if we run the app and click on the remove button, the following error will be thrown:</p>\n<p><img src=\"https://i.postimg.cc/kXrd6Rw4/Selection-512.jpg\" alt=\"vue error\"></p>\n<p>Since there is no vue, instance, the $emit function is not available, so we have to find another way for sending the <code class=\"language-text\">remove-note</code> event to the parent.</p>\n<h2 id=\"sending-events-from-functional-components\"><a href=\"#sending-events-from-functional-components\" aria-hidden=\"true\"><span class=\"icon icon-link heading-anchor\"></span></a>Sending events from functional components.</h2>\n<p>A pattern for sending events to a parent that is not described in the official docs is to directly call the event handler from the <code class=\"language-text\">listeners</code> property\nand pass in any required arguments</p>\n<p>NoteListItem.vue</p>\n<pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>template</span> <span class=\"token attr-name\">functional</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span>{{props.note.description}}<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">@click</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>listeners[<span class=\"token punctuation\">'</span>remove-note<span class=\"token punctuation\">'</span>](props.note.id)<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Remove<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>template</span><span class=\"token punctuation\">></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\">\n<span class=\"token keyword module\">export</span> <span class=\"token keyword module\">default</span> <span class=\"token punctuation\">{</span>\n  props<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    note<span class=\"token operator\">:</span> <span class=\"token known-class-name class-name\">Object</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n</span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span></code></pre>\n<h3 id=\"interesting-caveats\"><a href=\"#interesting-caveats\" aria-hidden=\"true\"><span class=\"icon icon-link heading-anchor\"></span></a>Interesting caveats</h3>\n<ul>\n<li>Like in normal components, we can pass in $event as an argument to the handler.</li>\n<li>We can get rid of the <script> section, since the props property is optional and is used only for validation.</li>\n</ul>\n<p>The final code for this component can be seen in this <a href=\"https://codesandbox.io/s/lucid-brown-rf6t9\" target=\"_blank\" rel=\"noopener\">code sandbox project</a></p>\n<p>Happy coding!!ðŸš€ðŸš€ðŸš€ðŸš€ðŸš€</p>\n","published":"April 19, 2021","updated":"April 19, 2021","summary":"Functional components have a scary name for something that is supposed to be so simple. In this article I will briefly explain what are functional components and how we can use them to send events to a parent component","tags":[{"title":"vue","path":"/blog/tag/vue/"}]}},"context":{}}