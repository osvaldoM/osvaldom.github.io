<!DOCTYPE html>
<html data-html-server-rendered="true" lang="en" data-vue-tag="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title>Dealing with currencies - osvaldom</title><meta name="gridsome:hash" content="a941cfc8a755852400b6b1869ed12f7f8679f500"><meta data-vue-tag="ssr" charset="utf-8"><meta data-vue-tag="ssr" name="generator" content="Gridsome v0.7.21"><meta data-vue-tag="ssr" data-key="viewport" name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><meta data-vue-tag="ssr" data-key="format-detection" name="format-detection" content="telephone=no"><meta data-vue-tag="ssr" data-key="description" name="description" content="Osvaldo&#x27;s online location"><link data-vue-tag="ssr" rel="icon" href="data:,"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="16x16" href="/assets/static/favicon.ce0531f.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="32x32" href="/assets/static/favicon.ac8d93a.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="96x96" href="/assets/static/favicon.b9532cc.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="76x76" href="/assets/static/favicon.f22e9f3.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="152x152" href="/assets/static/favicon.62d22cb.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="120x120" href="/assets/static/favicon.1539b60.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="167x167" href="/assets/static/favicon.dc0cdc5.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="180x180" href="/assets/static/favicon.7b22250.9bb7ffafafc09ac851d81afb65b8ef59.png"><link rel="preload" href="/assets/css/0.styles.3a58809f.css" as="style"><link rel="preload" href="/assets/js/app.03b43336.js" as="script"><link rel="preload" href="/assets/js/page--src--templates--article-vue.b02a265e.js" as="script"><link rel="prefetch" href="/assets/js/page--node-modules--gridsome--app--pages--404-vue.0ceeaddd.js"><link rel="prefetch" href="/assets/js/page--src--pages--blog-vue.a576c2b7.js"><link rel="prefetch" href="/assets/js/page--src--pages--index-vue.4066dea2.js"><link rel="prefetch" href="/assets/js/page--src--pages--portfolio-vue.ccdc41e2.js"><link rel="stylesheet" href="/assets/css/0.styles.3a58809f.css"><noscript data-vue-tag="ssr"><style>.g-image--loading{display:none;}</style></noscript>
  </head>
  <body >
    <div data-server-rendered="true" id="app" data-v-8edcaf46><p data-v-8edcaf46>Dealing with currencies</p><div data-v-8edcaf46><h1 id="dealing-with-currencies"><a href="#dealing-with-currencies" aria-hidden="true"><span class="icon icon-link"></span></a>Dealing with currencies</h1>
<h2 id="how-we-operate-with-currencies-in-php-and-what-problems-does-it-have"><a href="#how-we-operate-with-currencies-in-php-and-what-problems-does-it-have" aria-hidden="true"><span class="icon icon-link"></span></a>How we operate with currencies in PHP and what problems does it have?</h2>
<p>One recurring mistake developers make is to perform mathematical operations on currencies using floats(floating point numbers), which might cause rounding errors and other issues.
One common approach to working with currencies is to use Martin Fowler's money pattern which in summary means:.</p>
<ul>
<li>Deal in the currencies smallest unit (for dollars that's cents, but don't assume all currencies have the same smallest unit).</li>
<li>Store amounts as strings (for some cases, integers can be used)</li>
<li>Perform all arithmetic operations using the BC or GMP extensions. For this example I used BCMath</li>
</ul>
<p>This approach is valid for cryptocurrencies as well, but we have to define a base fractional unit for the specific cryptocurrency we want to work with.</p>
<h2 id="what-is-the-best-way-to-store-them-in-the-database"><a href="#what-is-the-best-way-to-store-them-in-the-database" aria-hidden="true"><span class="icon icon-link"></span></a>What is the best way to store them in the Database?</h2>
<p>I believe that the best way for storing currencies in the database whenever possible would be to store the value as a decimal/numeric data type in one column and store the currency in a separate column (either a Foreign Key or an ISO currency code). Decimal/numeric data types have enough precision to support most common operations on currencies without losing accuracy.</p>
<p>Alternatively, they could be stored as strings(eg: 250 USD) but this could make arithmetic database operations more difficult, which would also make reporting/analytics for instance, more complicated.</p>
<h2 id="articles-about-martin-fowlers-pattern"><a href="#articles-about-martin-fowlers-pattern" aria-hidden="true"><span class="icon icon-link"></span></a>Articles about Martin Fowler's pattern:</h2>
<p><a href="https://code.tutsplus.com/tutorials/money-pattern-the-right-way-to-represent-value-unit-pairs--net-35509" target="_blank" rel="nofollow noopener noreferrer">https://code.tutsplus.com/tutorials/money-pattern-the-right-way-to-represent-value-unit-pairs--net-35509</a>
<a href="https://culttt.com/2014/05/28/handle-money-currency-web-applications/" target="_blank" rel="nofollow noopener noreferrer">https://culttt.com/2014/05/28/handle-money-currency-web-applications/</a>
<a href="https://culttt.com/2014/06/04/working-money-currency-php/" target="_blank" rel="nofollow noopener noreferrer">https://culttt.com/2014/06/04/working-money-currency-php/</a>
<a href="https://www.reddit.com/r/PHP/comments/4sxukz/how_to_properly_handle_money_in_php_and_mysql/" target="_blank" rel="nofollow noopener noreferrer">https://www.reddit.com/r/PHP/comments/4sxukz/how_to_properly_handle_money_in_php_and_mysql/</a></p>
<h2 id="comparison-of-several-patterns-for-the-money-class"><a href="#comparison-of-several-patterns-for-the-money-class" aria-hidden="true"><span class="icon icon-link"></span></a>Comparison of several patterns for the Money class</h2>
<p><a href="https://deque.blog/2017/08/17/a-study-of-4-money-class-designs-featuring-martin-fowler-kent-beck-and-ward-cunningham-implementations/" target="_blank" rel="nofollow noopener noreferrer">https://deque.blog/2017/08/17/a-study-of-4-money-class-designs-featuring-martin-fowler-kent-beck-and-ward-cunningham-implementations/</a></p>
</div></div>
    <script>window.__INITIAL_STATE__={"data":{"article":{"title":"Dealing with currencies","content":"\u003Ch1 id=\"dealing-with-currencies\"\u003E\u003Ca href=\"#dealing-with-currencies\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EDealing with currencies\u003C\u002Fh1\u003E\n\u003Ch2 id=\"how-we-operate-with-currencies-in-php-and-what-problems-does-it-have\"\u003E\u003Ca href=\"#how-we-operate-with-currencies-in-php-and-what-problems-does-it-have\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EHow we operate with currencies in PHP and what problems does it have?\u003C\u002Fh2\u003E\n\u003Cp\u003EOne recurring mistake developers make is to perform mathematical operations on currencies using floats(floating point numbers), which might cause rounding errors and other issues.\nOne common approach to working with currencies is to use Martin Fowler's money pattern which in summary means:.\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003EDeal in the currencies smallest unit (for dollars that's cents, but don't assume all currencies have the same smallest unit).\u003C\u002Fli\u003E\n\u003Cli\u003EStore amounts as strings (for some cases, integers can be used)\u003C\u002Fli\u003E\n\u003Cli\u003EPerform all arithmetic operations using the BC or GMP extensions. For this example I used BCMath\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cp\u003EThis approach is valid for cryptocurrencies as well, but we have to define a base fractional unit for the specific cryptocurrency we want to work with.\u003C\u002Fp\u003E\n\u003Ch2 id=\"what-is-the-best-way-to-store-them-in-the-database\"\u003E\u003Ca href=\"#what-is-the-best-way-to-store-them-in-the-database\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EWhat is the best way to store them in the Database?\u003C\u002Fh2\u003E\n\u003Cp\u003EI believe that the best way for storing currencies in the database whenever possible would be to store the value as a decimal\u002Fnumeric data type in one column and store the currency in a separate column (either a Foreign Key or an ISO currency code). Decimal\u002Fnumeric data types have enough precision to support most common operations on currencies without losing accuracy.\u003C\u002Fp\u003E\n\u003Cp\u003EAlternatively, they could be stored as strings(eg: 250 USD) but this could make arithmetic database operations more difficult, which would also make reporting\u002Fanalytics for instance, more complicated.\u003C\u002Fp\u003E\n\u003Ch2 id=\"articles-about-martin-fowlers-pattern\"\u003E\u003Ca href=\"#articles-about-martin-fowlers-pattern\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EArticles about Martin Fowler's pattern:\u003C\u002Fh2\u003E\n\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fcode.tutsplus.com\u002Ftutorials\u002Fmoney-pattern-the-right-way-to-represent-value-unit-pairs--net-35509\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Ehttps:\u002F\u002Fcode.tutsplus.com\u002Ftutorials\u002Fmoney-pattern-the-right-way-to-represent-value-unit-pairs--net-35509\u003C\u002Fa\u003E\n\u003Ca href=\"https:\u002F\u002Fculttt.com\u002F2014\u002F05\u002F28\u002Fhandle-money-currency-web-applications\u002F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Ehttps:\u002F\u002Fculttt.com\u002F2014\u002F05\u002F28\u002Fhandle-money-currency-web-applications\u002F\u003C\u002Fa\u003E\n\u003Ca href=\"https:\u002F\u002Fculttt.com\u002F2014\u002F06\u002F04\u002Fworking-money-currency-php\u002F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Ehttps:\u002F\u002Fculttt.com\u002F2014\u002F06\u002F04\u002Fworking-money-currency-php\u002F\u003C\u002Fa\u003E\n\u003Ca href=\"https:\u002F\u002Fwww.reddit.com\u002Fr\u002FPHP\u002Fcomments\u002F4sxukz\u002Fhow_to_properly_handle_money_in_php_and_mysql\u002F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Ehttps:\u002F\u002Fwww.reddit.com\u002Fr\u002FPHP\u002Fcomments\u002F4sxukz\u002Fhow_to_properly_handle_money_in_php_and_mysql\u002F\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Ch2 id=\"comparison-of-several-patterns-for-the-money-class\"\u003E\u003Ca href=\"#comparison-of-several-patterns-for-the-money-class\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EComparison of several patterns for the Money class\u003C\u002Fh2\u003E\n\u003Cp\u003E\u003Ca href=\"https:\u002F\u002Fdeque.blog\u002F2017\u002F08\u002F17\u002Fa-study-of-4-money-class-designs-featuring-martin-fowler-kent-beck-and-ward-cunningham-implementations\u002F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Ehttps:\u002F\u002Fdeque.blog\u002F2017\u002F08\u002F17\u002Fa-study-of-4-money-class-designs-featuring-martin-fowler-kent-beck-and-ward-cunningham-implementations\u002F\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n"}},"context":{}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script><script src="/assets/js/app.03b43336.js" defer></script><script src="/assets/js/page--src--templates--article-vue.b02a265e.js" defer></script>
  </body>
</html>
